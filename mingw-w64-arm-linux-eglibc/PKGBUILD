# Maintainer: Tim S <stahta01@gmail.com>

_basename=eglibc
_realname_prefix=arm-linux-
_realname=${_realname_prefix}${_basename}
_filename=${_basename}
_foldername=${_basename}
_target=arm-linux-gnueabi

pkgbase=mingw-w64-${_realname}
pkgname=("${MINGW_PACKAGE_PREFIX}-${_target}-${_realname}")
pkgver=2.13
pkgrel=1
pkgdesc="A C standard library implementation for the ARM microprocessors (mingw-w64)"
arch=('any')
url="http://www.eglibc.org"
license=('(L)GPL')
groups=("${MINGW_PACKAGE_PREFIX}-${_target}-toolchain")
depends=()
makedepends=("${MINGW_PACKAGE_PREFIX}-boot-arm-linux-gcc" "${MINGW_PACKAGE_PREFIX}-${_target}-binutils")
options=('staticlibs' '!strip' '!emptydirs')
source=("https://archive.raspbian.org/raspbian/pool/main/e/eglibc/eglibc_${pkgver}.orig.tar.gz")
md5sums=('be63a487c69b3f4198def94d7254b250')

prepare() {
  cd ${srcdir}/${_foldername}-${pkgver}
}

build() {
  if [[ -d "build-libc-${CARCH}" ]]; then
    rm -rf build-libc-${CARCH}
  fi
  mkdir build-libc-${CARCH}
  cd build-libc-${CARCH}

  RANLIB=$PREFIX/bin/${_target}-ranlib \
  MAKEINFO=: \
  ../${_foldername}-${pkgver}/configure \
    --prefix=${MINGW_PREFIX} \
    --with-headers=/usr/$_target \
    --build=${MINGW_CHOST} \
    --host=${MINGW_CHOST} \
    --enable-kernel=3.0.0 \
    --disable-profile --without-gd \
    --without-cvs --enable-add-ons
}

package() {
  cd ${srcdir}/build-libc-${CARCH}
}
